2024-07-13 21:25:09,935 - __main__ - INFO - Setup and Imports complete.
2024-07-13 21:25:09,944 - __main__ - INFO - Loading and preparing data...
2024-07-13 21:25:24,902 - __main__ - INFO - Memory usage after optimization is: 218.68 MB
2024-07-13 21:25:24,903 - __main__ - INFO - Decreased by 79.17%
2024-07-13 21:25:25,255 - __main__ - INFO - Memory usage after optimization is: 138.98 MB
2024-07-13 21:25:25,256 - __main__ - INFO - Decreased by 78.41%
2024-07-13 21:25:25,746 - __main__ - INFO - Train dataset shape: (11465233, 11)
2024-07-13 21:25:25,747 - __main__ - INFO - Test dataset shape: (7669866, 10)
2024-07-13 21:25:30,277 - __main__ - INFO - Training set shape: (9172186, 10)
2024-07-13 21:25:30,278 - __main__ - INFO - Validation set shape: (2293047, 10)
2024-07-13 21:25:30,286 - __main__ - INFO - Defining custom transformers...
2024-07-13 21:25:30,288 - __main__ - INFO - Custom transformers defined.
2024-07-13 21:25:30,297 - __main__ - INFO - Defining preprocessing pipeline...
2024-07-13 21:25:32,652 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:32,653 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:34,202 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:34,203 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:35,768 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:35,769 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:37,493 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:37,493 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:39,006 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:39,006 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:40,540 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:40,541 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:42,763 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:42,763 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:44,280 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:44,281 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:45,819 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:45,820 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:47,901 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:47,901 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:49,418 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:49,419 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:50,927 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:50,927 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:55,548 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:55,549 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:55,926 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:55,926 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:56,310 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\category_encoders\ordinal.py:198: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
2024-07-13 21:25:56,311 - __main__ - ERROR -   X[column] = X[column].astype("object").fillna(np.nan).map(col_mapping)
2024-07-13 21:25:56,893 - __main__ - INFO - Training set after preprocessing: (9172186, 22)
2024-07-13 21:25:56,894 - __main__ - INFO - Validation set after preprocessing: (2293047, 22)
2024-07-13 21:25:56,900 - __main__ - INFO - Saving transformed data...
2024-07-13 21:29:46,078 - __main__ - INFO - Transformed datasets saved to CSV files with reduced memory usage
2024-07-13 21:29:46,086 - __main__ - INFO - Running Bayesian search for hyperparameter tuning...
2024-07-13 21:29:46,087 - __main__ - ERROR - c:\Users\paulo\anaconda3\envs\pytorch_env\Lib\site-packages\sklearn\metrics\_scorer.py:548: FutureWarning: The `needs_threshold` and `needs_proba` parameter are deprecated in version 1.4 and will be removed in 1.6. You can either let `response_method` be `None` or set it to `predict` to preserve the same behaviour.
2024-07-13 21:29:46,087 - __main__ - ERROR -   warnings.warn(
2024-07-13 21:29:46,241 - __main__ - INFO - Fitting 3 folds for each of 1 candidates, totalling 3 fits
2024-07-13 21:30:50,031 - __main__ - INFO - [LightGBM] [Warning] min_data_in_leaf is set=40, min_child_samples=20 will be ignored. Current value: min_data_in_leaf=40
2024-07-13 21:30:50,031 - __main__ - INFO - [LightGBM] [Warning] feature_fraction is set=0.7865735997695669, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.7865735997695669
2024-07-13 21:30:50,033 - __main__ - INFO - [LightGBM] [Warning] lambda_l1 is set=0.3157995934870487, reg_alpha=0.0 will be ignored. Current value: lambda_l1=0.3157995934870487
2024-07-13 21:30:50,033 - __main__ - INFO - [LightGBM] [Warning] lambda_l2 is set=0.6701479482689346, reg_lambda=0.0 will be ignored. Current value: lambda_l2=0.6701479482689346
2024-07-13 21:30:50,034 - __main__ - INFO - [LightGBM] [Warning] bagging_fraction is set=0.6820207917706628, subsample=1.0 will be ignored. Current value: bagging_fraction=0.6820207917706628
2024-07-13 21:30:50,034 - __main__ - INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
2024-07-13 21:30:51,403 - __main__ - INFO - [LightGBM] [Warning] min_data_in_leaf is set=40, min_child_samples=20 will be ignored. Current value: min_data_in_leaf=40
2024-07-13 21:30:51,405 - __main__ - INFO - [LightGBM] [Warning] feature_fraction is set=0.7865735997695669, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.7865735997695669
2024-07-13 21:30:51,406 - __main__ - INFO - [LightGBM] [Warning] lambda_l1 is set=0.3157995934870487, reg_alpha=0.0 will be ignored. Current value: lambda_l1=0.3157995934870487
2024-07-13 21:30:51,407 - __main__ - INFO - [LightGBM] [Warning] lambda_l2 is set=0.6701479482689346, reg_lambda=0.0 will be ignored. Current value: lambda_l2=0.6701479482689346
2024-07-13 21:30:51,407 - __main__ - INFO - [LightGBM] [Warning] bagging_fraction is set=0.6820207917706628, subsample=1.0 will be ignored. Current value: bagging_fraction=0.6820207917706628
2024-07-13 21:30:51,408 - __main__ - INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
2024-07-13 21:30:51,413 - __main__ - INFO - [LightGBM] [Info] Number of positive: 1129070, number of negative: 8043116
2024-07-13 21:30:51,776 - __main__ - INFO - [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.339226 seconds.
2024-07-13 21:30:51,776 - __main__ - INFO - You can set `force_col_wise=true` to remove the overhead.
2024-07-13 21:30:51,785 - __main__ - INFO - [LightGBM] [Info] Total Bins 3614
2024-07-13 21:30:51,786 - __main__ - INFO - [LightGBM] [Info] Number of data points in the train set: 9172186, number of used features: 22
2024-07-13 21:30:51,864 - __main__ - INFO - [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.123097 -> initscore=-1.963422
2024-07-13 21:30:51,869 - __main__ - INFO - [LightGBM] [Info] Start training from score -1.963422
2024-07-13 21:31:20,511 - __main__ - INFO - Best AUC: 0.8760875621790157
2024-07-13 21:31:20,513 - __main__ - INFO - Best parameters: OrderedDict({'bagging_fraction': 0.6820207917706628, 'bagging_freq': 5, 'feature_fraction': 0.7865735997695669, 'lambda_l1': 0.3157995934870487, 'lambda_l2': 0.6701479482689346, 'learning_rate': 0.0589883042739877, 'max_depth': 12, 'min_data_in_leaf': 40, 'num_leaves': 78})
2024-07-13 21:31:21,136 - __main__ - INFO - [LightGBM] [Warning] min_data_in_leaf is set=40, min_child_samples=20 will be ignored. Current value: min_data_in_leaf=40
2024-07-13 21:31:21,136 - __main__ - INFO - [LightGBM] [Warning] feature_fraction is set=0.7865735997695669, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.7865735997695669
2024-07-13 21:31:21,137 - __main__ - INFO - [LightGBM] [Warning] lambda_l1 is set=0.3157995934870487, reg_alpha=0.0 will be ignored. Current value: lambda_l1=0.3157995934870487
2024-07-13 21:31:21,137 - __main__ - INFO - [LightGBM] [Warning] lambda_l2 is set=0.6701479482689346, reg_lambda=0.0 will be ignored. Current value: lambda_l2=0.6701479482689346
2024-07-13 21:31:21,138 - __main__ - INFO - [LightGBM] [Warning] bagging_fraction is set=0.6820207917706628, subsample=1.0 will be ignored. Current value: bagging_fraction=0.6820207917706628
2024-07-13 21:31:21,138 - __main__ - INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
2024-07-13 21:31:22,514 - __main__ - INFO - [LightGBM] [Warning] min_data_in_leaf is set=40, min_child_samples=20 will be ignored. Current value: min_data_in_leaf=40
2024-07-13 21:31:22,515 - __main__ - INFO - [LightGBM] [Warning] feature_fraction is set=0.7865735997695669, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.7865735997695669
2024-07-13 21:31:22,515 - __main__ - INFO - [LightGBM] [Warning] lambda_l1 is set=0.3157995934870487, reg_alpha=0.0 will be ignored. Current value: lambda_l1=0.3157995934870487
2024-07-13 21:31:22,516 - __main__ - INFO - [LightGBM] [Warning] lambda_l2 is set=0.6701479482689346, reg_lambda=0.0 will be ignored. Current value: lambda_l2=0.6701479482689346
2024-07-13 21:31:22,516 - __main__ - INFO - [LightGBM] [Warning] bagging_fraction is set=0.6820207917706628, subsample=1.0 will be ignored. Current value: bagging_fraction=0.6820207917706628
2024-07-13 21:31:22,517 - __main__ - INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
2024-07-13 21:31:22,523 - __main__ - INFO - [LightGBM] [Info] Number of positive: 1129070, number of negative: 8043116
2024-07-13 21:31:22,866 - __main__ - INFO - [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.321471 seconds.
2024-07-13 21:31:22,866 - __main__ - INFO - You can set `force_col_wise=true` to remove the overhead.
2024-07-13 21:31:22,874 - __main__ - INFO - [LightGBM] [Info] Total Bins 3614
2024-07-13 21:31:22,875 - __main__ - INFO - [LightGBM] [Info] Number of data points in the train set: 9172186, number of used features: 22
2024-07-13 21:31:22,959 - __main__ - INFO - [LightGBM] [Info] [binary:BoostFromScore]: pavg=0.123097 -> initscore=-1.963422
2024-07-13 21:31:22,964 - __main__ - INFO - [LightGBM] [Info] Start training from score -1.963422
2024-07-13 21:31:51,703 - __main__ - INFO - Bayesian search complete.
2024-07-13 21:31:51,711 - __main__ - INFO - Evaluating model...
2024-07-13 21:31:52,032 - __main__ - INFO - [LightGBM] [Warning] min_data_in_leaf is set=40, min_child_samples=20 will be ignored. Current value: min_data_in_leaf=40
2024-07-13 21:31:52,032 - __main__ - INFO - [LightGBM] [Warning] feature_fraction is set=0.7865735997695669, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.7865735997695669
2024-07-13 21:31:52,033 - __main__ - INFO - [LightGBM] [Warning] lambda_l1 is set=0.3157995934870487, reg_alpha=0.0 will be ignored. Current value: lambda_l1=0.3157995934870487
2024-07-13 21:31:52,034 - __main__ - INFO - [LightGBM] [Warning] lambda_l2 is set=0.6701479482689346, reg_lambda=0.0 will be ignored. Current value: lambda_l2=0.6701479482689346
2024-07-13 21:31:52,034 - __main__ - INFO - [LightGBM] [Warning] bagging_fraction is set=0.6820207917706628, subsample=1.0 will be ignored. Current value: bagging_fraction=0.6820207917706628
2024-07-13 21:31:52,034 - __main__ - INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
2024-07-13 21:32:02,263 - __main__ - INFO - [LightGBM] [Warning] min_data_in_leaf is set=40, min_child_samples=20 will be ignored. Current value: min_data_in_leaf=40
2024-07-13 21:32:02,263 - __main__ - INFO - [LightGBM] [Warning] feature_fraction is set=0.7865735997695669, colsample_bytree=1.0 will be ignored. Current value: feature_fraction=0.7865735997695669
2024-07-13 21:32:02,263 - __main__ - INFO - [LightGBM] [Warning] lambda_l1 is set=0.3157995934870487, reg_alpha=0.0 will be ignored. Current value: lambda_l1=0.3157995934870487
2024-07-13 21:32:02,265 - __main__ - INFO - [LightGBM] [Warning] lambda_l2 is set=0.6701479482689346, reg_lambda=0.0 will be ignored. Current value: lambda_l2=0.6701479482689346
2024-07-13 21:32:02,265 - __main__ - INFO - [LightGBM] [Warning] bagging_fraction is set=0.6820207917706628, subsample=1.0 will be ignored. Current value: bagging_fraction=0.6820207917706628
2024-07-13 21:32:02,266 - __main__ - INFO - [LightGBM] [Warning] bagging_freq is set=5, subsample_freq=0 will be ignored. Current value: bagging_freq=5
2024-07-13 21:32:04,723 - __main__ - INFO - Training AUC with best parameters: 0.8767725538421669
2024-07-13 21:32:04,723 - __main__ - INFO - Validation AUC with best parameters: 0.8770165542272811
2024-07-13 21:32:04,723 - __main__ - INFO - No overfitting detected: Train AUC - 0.8767725538421669, Val AUC - 0.8770165542272811, Difference - 0.00024400038511418476
2024-07-13 21:32:04,730 - __main__ - INFO - Model evaluation complete.
2024-07-13 21:32:04,736 - __main__ - INFO - Training final model with callbacks...
2024-07-13 21:32:06,447 - __main__ - INFO - [LightGBM] [Info] Auto-choosing col-wise multi-threading, the overhead of testing was 0.270206 seconds.
2024-07-13 21:32:06,447 - __main__ - INFO - You can set `force_col_wise=true` to remove the overhead.
2024-07-13 21:32:06,457 - __main__ - INFO - [LightGBM] [Info] Total Bins 3614
2024-07-13 21:32:06,458 - __main__ - INFO - [LightGBM] [Info] Number of data points in the train set: 9172186, number of used features: 22
2024-07-13 21:32:06,889 - __main__ - INFO - [LightGBM] [Info] Start training from score 0.123097
2024-07-13 21:32:07,191 - __main__ - INFO - Training until validation scores don't improve for 20 rounds
2024-07-13 21:32:52,688 - __main__ - INFO - Did not meet early stopping. Best iteration is:
2024-07-13 21:32:52,689 - __main__ - INFO - [200]	training's l2: 0.0827566	valid_1's l2: 0.0827882
2024-07-13 21:32:52,690 - __main__ - INFO - Evaluated only: l2
2024-07-13 21:32:52,763 - __main__ - INFO - Saving model and metrics...
2024-07-13 21:33:12,298 - __main__ - INFO - Final Train AUC: 0.8779369845846525
2024-07-13 21:33:12,299 - __main__ - INFO - Final Validation AUC: 0.877908227878115
2024-07-13 21:33:12,301 - __main__ - INFO - Feature importance saved as feature_importance.csv
2024-07-13 21:33:12,534 - __main__ - INFO - Feature importance plot saved as feature_importance.png
2024-07-13 21:33:12,705 - __main__ - INFO - Model saved as lightgbm_model_best.pkl
2024-07-13 21:33:12,708 - __main__ - INFO - Model metrics saved as model_metrics.csv
2024-07-13 21:33:12,708 - __main__ - INFO - Training and evaluation process completed successfully.
